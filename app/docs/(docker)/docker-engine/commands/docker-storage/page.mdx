# Docker Storage

## What is Docker Storage
Docker Storage คือกลไกในการจัดการข้อมูล (Data) ของ Container ให้มีความยั่งยืน (Persistence) เนื่องจากโดยปกติแล้วข้อมูลที่เกิดขึ้นภายใน Container จะเป็นข้อมูลชั่วคราว (Ephemeral) ซึ่งจะหายไปทันทีเมื่อ Container ถูกลบ ดังนั้นหากเราต้องการเก็บรักษาข้อมูลสำคัญ เช่น ฐานข้อมูล หรือ Log files เราจำเป็นต้องใช้ Docker Storage เพื่อ Map พื้นที่จัดเก็บข้อมูลออกมาไว้นอก Container

## Docker Volumes
**Docker Volumes** เป็นวิธีมาตรฐานและปลอดภัยที่สุดในการจัดเก็บข้อมูล โดย Docker จะทำการสร้างพื้นที่จัดเก็บข้อมูลขึ้นมาเอง (Managed by Docker) ภายใต้ path `/var/lib/docker/volumes/<volume-name>/_data` บนเครื่อง Host วิธีนี้ทำให้เราไม่ต้องกังวลเรื่อง Path ของเครื่อง Host และสามารถแชร์ข้อมูลระหว่าง Container ได้ง่าย

### Volume Example
การสร้าง Volume ชื่อ my-data และนำไป Mount เข้ากับ Container (เช่น Nginx)
```bash
# สร้าง Volume ใหม่
docker volume create my-data

# รัน Container โดย Mount volume 'my-data' ไปที่ '/app' ใน Container
docker run -d -v my-data:/app nginx
```
การตรวจสอบรายการ Volume ที่มีอยู่

```bash
docker volume ls
```

## Bind Mounts
**Bind Mounts** เป็นวิธีที่เชื่อมโยงไฟล์หรือโฟลเดอร์จากตำแหน่งที่ระบุเจาะจงบนเครื่อง Host (Host Path) เข้ากับ Container โดยตรง วิธีนี้มีความยืดหยุ่นสูงและนิยมใช้ในขั้นตอนการพัฒนา (Development) เช่น การแก้ Source code บนเครื่องเราแล้วให้ผลลัพธ์เปลี่ยนใน Container ทันที

### Bind Mounts Example
การรัน Container โดยเชื่อมโฟลเดอร์ปัจจุบัน (`$(pwd)`) บนเครื่อง Host เข้าไปที่ `/usr/share/nginx/html` ใน Container
```bash
# ใช้ -v [Host Path]:[Container Path]
docker run -d -p 8080:80 -v $(pwd)/html:/usr/share/nginx/html nginx
```
> *หากเราแก้ไขไฟล์ index.html ในโฟลเดอร์ html บนเครื่อง Host หน้าเว็บใน Container ก็จะเปลี่ยนตามทันที*